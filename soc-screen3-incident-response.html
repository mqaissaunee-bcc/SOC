<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC Screen 3: Incident Response Console</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        .header {
            background: linear-gradient(90deg, #1a1a2e 0%, #16213e 100%);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e74c3c;
        }
        
        .header h1 {
            font-size: 1.8em;
            color: #e74c3c;
            text-shadow: 0 0 10px rgba(231, 76, 60, 0.5);
        }
        
        .header-info {
            display: flex;
            gap: 30px;
            align-items: center;
        }
        
        .datetime {
            font-size: 1.1em;
            color: #e74c3c;
        }
        
        .incident-stats {
            display: flex;
            gap: 25px;
        }
        
        .incident-stat {
            text-align: center;
            padding: 5px 15px;
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
        }
        
        .incident-stat-value {
            font-size: 1.4em;
            font-weight: bold;
        }
        
        .incident-stat-label {
            font-size: 0.7em;
            color: #888;
            text-transform: uppercase;
        }
        
        .main-container {
            display: grid;
            grid-template-columns: 350px 1fr 300px;
            grid-template-rows: 1fr 1fr;
            gap: 15px;
            padding: 15px;
            height: calc(100vh - 80px);
        }
        
        .card {
            background: linear-gradient(145deg, #1e1e30 0%, #252540 100%);
            border-radius: 12px;
            padding: 15px;
            border: 1px solid #333;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }
        
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #444;
        }
        
        .card-title {
            font-size: 1em;
            color: #e74c3c;
            font-weight: 600;
        }
        
        /* Incident Queue */
        .incident-queue {
            grid-row: 1 / -1;
        }
        
        .incident-list {
            flex: 1;
            overflow-y: auto;
        }
        
        .incident-list::-webkit-scrollbar {
            width: 6px;
        }
        
        .incident-list::-webkit-scrollbar-thumb {
            background: #e74c3c;
            border-radius: 3px;
        }
        
        .incident-item {
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 10px;
            border-left: 4px solid;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .incident-item:hover {
            background: rgba(231, 76, 60, 0.1);
            transform: translateX(3px);
        }
        
        .incident-item.selected {
            background: rgba(231, 76, 60, 0.2);
            border-color: #e74c3c;
        }
        
        .incident-item.severity-critical { border-left-color: #ff4757; }
        .incident-item.severity-high { border-left-color: #ffa502; }
        .incident-item.severity-medium { border-left-color: #ffd43b; }
        .incident-item.severity-low { border-left-color: #2ed573; }
        
        .incident-id {
            font-size: 0.8em;
            color: #888;
            margin-bottom: 5px;
        }
        
        .incident-title {
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 0.95em;
        }
        
        .incident-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #888;
        }
        
        .incident-status {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75em;
            text-transform: uppercase;
        }
        
        .status-new { background: rgba(231,76,60,0.3); color: #e74c3c; }
        .status-investigating { background: rgba(241,196,15,0.3); color: #f1c40f; }
        .status-contained { background: rgba(52,152,219,0.3); color: #3498db; }
        .status-resolved { background: rgba(46,213,115,0.3); color: #2ed573; }
        
        /* Case Details */
        .case-details {
            grid-column: 2;
        }
        
        .case-content {
            flex: 1;
            overflow-y: auto;
        }
        
        .case-section {
            margin-bottom: 20px;
        }
        
        .case-section-title {
            font-size: 0.9em;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 10px;
            padding-bottom: 5px;
            border-bottom: 1px solid #333;
        }
        
        .case-info-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
        }
        
        .case-info-item {
            background: rgba(0,0,0,0.2);
            padding: 12px;
            border-radius: 8px;
        }
        
        .case-info-label {
            font-size: 0.75em;
            color: #888;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .case-info-value {
            font-size: 1em;
            color: #e0e0e0;
        }
        
        /* IOC List */
        .ioc-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .ioc-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(0,0,0,0.2);
            border-radius: 6px;
            font-family: monospace;
            font-size: 0.85em;
        }
        
        .ioc-type {
            padding: 2px 8px;
            border-radius: 4px;
            font-size: 0.75em;
            min-width: 50px;
            text-align: center;
        }
        
        .ioc-type.ip { background: rgba(231,76,60,0.3); color: #e74c3c; }
        .ioc-type.hash { background: rgba(155,89,182,0.3); color: #9b59b6; }
        .ioc-type.domain { background: rgba(52,152,219,0.3); color: #3498db; }
        .ioc-type.file { background: rgba(241,196,15,0.3); color: #f1c40f; }
        
        /* Timeline */
        .timeline-section {
            grid-column: 2;
        }
        
        .attack-timeline {
            flex: 1;
            overflow-y: auto;
            position: relative;
            padding-left: 30px;
        }
        
        .timeline-line {
            position: absolute;
            left: 10px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #e74c3c, #333);
        }
        
        .timeline-event {
            position: relative;
            padding: 15px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 15px;
            border-left: 3px solid #e74c3c;
        }
        
        .timeline-event::before {
            content: '';
            position: absolute;
            left: -24px;
            top: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #e74c3c;
            border: 2px solid #1e1e30;
        }
        
        .timeline-time {
            font-size: 0.8em;
            color: #888;
            margin-bottom: 5px;
        }
        
        .timeline-title {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .timeline-description {
            font-size: 0.9em;
            color: #aaa;
        }
        
        .timeline-mitre {
            margin-top: 8px;
            font-size: 0.8em;
        }
        
        .mitre-tag {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(155,89,182,0.3);
            color: #9b59b6;
            border-radius: 4px;
            margin-right: 5px;
        }
        
        /* Response Actions */
        .response-panel {
            grid-row: 1 / -1;
        }
        
        .action-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .action-btn {
            padding: 12px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }
        
        .action-btn.contain {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
            color: white;
        }
        
        .action-btn.isolate {
            background: linear-gradient(135deg, #f39c12, #d68910);
            color: white;
        }
        
        .action-btn.block {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            color: white;
        }
        
        .action-btn.scan {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .action-btn.escalate {
            background: linear-gradient(135deg, #1abc9c, #16a085);
            color: white;
        }
        
        /* Analyst Notes */
        .notes-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .notes-list {
            flex: 1;
            overflow-y: auto;
            margin-bottom: 10px;
        }
        
        .note-item {
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 3px solid #3498db;
        }
        
        .note-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.8em;
            color: #888;
            margin-bottom: 5px;
        }
        
        .note-text {
            font-size: 0.9em;
        }
        
        .note-input-container {
            display: flex;
            gap: 10px;
        }
        
        .note-input {
            flex: 1;
            padding: 10px;
            border: 1px solid #444;
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
            color: #e0e0e0;
            font-size: 0.9em;
        }
        
        .note-input:focus {
            outline: none;
            border-color: #e74c3c;
        }
        
        .note-submit {
            padding: 10px 20px;
            background: #e74c3c;
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }
        
        /* Playbook Status */
        .playbook-section {
            margin-top: 20px;
        }
        
        .playbook-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px;
            margin-bottom: 5px;
        }
        
        .playbook-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid #444;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .playbook-checkbox.completed {
            background: #2ed573;
            border-color: #2ed573;
        }
        
        .playbook-checkbox.completed::after {
            content: '‚úì';
            color: white;
            font-size: 0.8em;
        }
        
        .playbook-checkbox.in-progress {
            border-color: #f1c40f;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(241, 196, 15, 0.4); }
            50% { box-shadow: 0 0 0 5px rgba(241, 196, 15, 0); }
        }
        
        .playbook-text {
            font-size: 0.85em;
        }
        
        .playbook-text.completed {
            text-decoration: line-through;
            color: #888;
        }
        
        /* Affected Assets */
        .assets-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .asset-item {
            padding: 10px;
            background: rgba(0,0,0,0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .asset-icon {
            width: 35px;
            height: 35px;
            background: rgba(231, 76, 60, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
        }
        
        .asset-info {
            flex: 1;
        }
        
        .asset-name {
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .asset-type {
            font-size: 0.75em;
            color: #888;
        }
        
        .asset-status {
            width: 10px;
            height: 10px;
            border-radius: 50%;
        }
        
        .asset-status.compromised { background: #ff4757; }
        .asset-status.at-risk { background: #ffa502; }
        .asset-status.clean { background: #2ed573; }
    </style>
</head>
<body>
    <header class="header">
        <h1>üö® Incident Response Console</h1>
        <div class="header-info">
            <div class="incident-stats">
                <div class="incident-stat">
                    <div class="incident-stat-value" style="color: #ff4757;" id="active-incidents">0</div>
                    <div class="incident-stat-label">Active</div>
                </div>
                <div class="incident-stat">
                    <div class="incident-stat-value" style="color: #f1c40f;" id="investigating">0</div>
                    <div class="incident-stat-label">Investigating</div>
                </div>
                <div class="incident-stat">
                    <div class="incident-stat-value" style="color: #3498db;" id="contained">0</div>
                    <div class="incident-stat-label">Contained</div>
                </div>
                <div class="incident-stat">
                    <div class="incident-stat-value" style="color: #2ed573;" id="resolved-today">0</div>
                    <div class="incident-stat-label">Resolved</div>
                </div>
            </div>
            <div class="datetime" id="datetime"></div>
        </div>
    </header>
    
    <main class="main-container">
        <!-- Incident Queue -->
        <div class="card incident-queue">
            <div class="card-header">
                <span class="card-title">üìã Active Incidents</span>
                <span id="queue-count">0</span>
            </div>
            <div class="incident-list" id="incident-list"></div>
        </div>
        
        <!-- Case Details -->
        <div class="card case-details">
            <div class="card-header">
                <span class="card-title">üìÅ Case Details</span>
                <span id="case-id">INC-2024-0001</span>
            </div>
            <div class="case-content" id="case-content">
                <div class="case-section">
                    <div class="case-section-title">Overview</div>
                    <div class="case-info-grid" id="case-overview"></div>
                </div>
                
                <div class="case-section">
                    <div class="case-section-title">Indicators of Compromise (IOCs)</div>
                    <div class="ioc-list" id="ioc-list"></div>
                </div>
                
                <div class="case-section">
                    <div class="case-section-title">Affected Assets</div>
                    <div class="assets-grid" id="assets-grid"></div>
                </div>
            </div>
        </div>
        
        <!-- Timeline -->
        <div class="card timeline-section">
            <div class="card-header">
                <span class="card-title">‚è±Ô∏è Attack Timeline</span>
            </div>
            <div class="attack-timeline" id="attack-timeline">
                <div class="timeline-line"></div>
            </div>
        </div>
        
        <!-- Response Actions Panel -->
        <div class="card response-panel">
            <div class="card-header">
                <span class="card-title">‚ö° Response Actions</span>
            </div>
            
            <div class="action-buttons">
                <button class="action-btn contain" onclick="performAction('contain')">
                    üõë Contain Threat
                </button>
                <button class="action-btn isolate" onclick="performAction('isolate')">
                    üîí Isolate Host
                </button>
                <button class="action-btn block" onclick="performAction('block')">
                    üö´ Block IP/Domain
                </button>
                <button class="action-btn scan" onclick="performAction('scan')">
                    üîç Full Scan
                </button>
                <button class="action-btn escalate" onclick="performAction('escalate')">
                    üì¢ Escalate to Tier 3
                </button>
            </div>
            
            <div class="playbook-section">
                <div class="case-section-title">Playbook Progress</div>
                <div id="playbook-steps"></div>
            </div>
            
            <div class="notes-section">
                <div class="case-section-title">Analyst Notes</div>
                <div class="notes-list" id="notes-list"></div>
                <div class="note-input-container">
                    <input type="text" class="note-input" id="note-input" placeholder="Add investigation note...">
                    <button class="note-submit" onclick="addNote()">Add</button>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        // Incident Types and Templates
        const incidentTypes = [
            // Critical - Malware (5)
            {
                type: 'Ransomware Attack',
                severity: 'critical',
                category: 'Malware',
                ttps: ['T1486', 'T1490', 'T1489'],
                playbook: ['Isolate affected systems', 'Identify ransomware variant', 'Check backup integrity', 'Assess encryption scope', 'Engage incident response team', 'Document all findings']
            },
            {
                type: 'C2 Communication',
                severity: 'critical',
                category: 'Malware',
                ttps: ['T1071', 'T1095', 'T1573'],
                playbook: ['Block C2 domains/IPs', 'Identify beacon behavior', 'Memory analysis', 'Network traffic capture', 'Malware removal']
            },
            {
                type: 'Cobalt Strike Beacon',
                severity: 'critical',
                category: 'Malware',
                ttps: ['T1071.001', 'T1055', 'T1059'],
                playbook: ['Isolate endpoint immediately', 'Capture memory dump', 'Extract beacon config', 'Block C2 infrastructure', 'Hunt for additional beacons']
            },
            {
                type: 'Emotet Infection',
                severity: 'critical',
                category: 'Malware',
                ttps: ['T1566.001', 'T1055', 'T1071'],
                playbook: ['Isolate infected host', 'Block email sender', 'Scan all endpoints', 'Check for lateral movement', 'Reset affected credentials']
            },
            {
                type: 'Wiper Malware',
                severity: 'critical',
                category: 'Malware',
                ttps: ['T1485', 'T1561', 'T1529'],
                playbook: ['Immediate isolation', 'Assess data destruction', 'Verify backup availability', 'Forensic imaging', 'Executive notification']
            },
            // Critical - Data Breach (3)
            {
                type: 'Data Exfiltration',
                severity: 'critical',
                category: 'Data Breach',
                ttps: ['T1041', 'T1048', 'T1567'],
                playbook: ['Block outbound connections', 'Identify data accessed', 'Review DLP alerts', 'Check cloud storage', 'Assess data sensitivity', 'Notify stakeholders']
            },
            {
                type: 'Database Breach',
                severity: 'critical',
                category: 'Data Breach',
                ttps: ['T1213', 'T1005', 'T1041'],
                playbook: ['Revoke database access', 'Audit query logs', 'Identify exfiltrated records', 'Assess PII exposure', 'Legal notification assessment']
            },
            {
                type: 'Cloud Data Exposure',
                severity: 'critical',
                category: 'Data Breach',
                ttps: ['T1530', 'T1537', 'T1567'],
                playbook: ['Review cloud access logs', 'Check storage permissions', 'Identify exposed data', 'Revoke public access', 'Enable logging']
            },
            // High - Credential (5)
            {
                type: 'Brute Force Attack',
                severity: 'high',
                category: 'Credential',
                ttps: ['T1110', 'T1078'],
                playbook: ['Review failed login attempts', 'Check account lockouts', 'Identify source IPs', 'Implement blocks', 'Reset affected credentials']
            },
            {
                type: 'Kerberoasting',
                severity: 'high',
                category: 'Credential',
                ttps: ['T1558.003', 'T1003'],
                playbook: ['Identify targeted service accounts', 'Check for password cracks', 'Rotate service account passwords', 'Enable AES encryption', 'Deploy honeytokens']
            },
            {
                type: 'DCSync Attack',
                severity: 'high',
                category: 'Credential',
                ttps: ['T1003.006', 'T1078'],
                playbook: ['Review replication logs', 'Identify attacking account', 'Revoke replication rights', 'Reset KRBTGT twice', 'Full credential rotation']
            },
            {
                type: 'Password Spraying',
                severity: 'high',
                category: 'Credential',
                ttps: ['T1110.003', 'T1078'],
                playbook: ['Analyze login patterns', 'Identify compromised accounts', 'Block source IPs', 'Force MFA enrollment', 'Strengthen password policy']
            },
            {
                type: 'MFA Bypass Attempt',
                severity: 'high',
                category: 'Credential',
                ttps: ['T1111', 'T1539'],
                playbook: ['Review MFA logs', 'Check for SIM swapping', 'Verify device registrations', 'Reset MFA tokens', 'User verification']
            },
            // High - Social Engineering (4)
            {
                type: 'Phishing Campaign',
                severity: 'high',
                category: 'Social Engineering',
                ttps: ['T1566', 'T1204'],
                playbook: ['Identify affected users', 'Block malicious URLs', 'Quarantine emails', 'Scan endpoints', 'User awareness reminder']
            },
            {
                type: 'Business Email Compromise',
                severity: 'high',
                category: 'Social Engineering',
                ttps: ['T1566.001', 'T1534'],
                playbook: ['Verify email authenticity', 'Check mail rules', 'Review financial requests', 'Contact account owner', 'Legal/Finance notification']
            },
            {
                type: 'Spearphishing Executive',
                severity: 'high',
                category: 'Social Engineering',
                ttps: ['T1566.001', 'T1598'],
                playbook: ['Isolate executive workstation', 'Review email attachments', 'Check for credential submission', 'VIP account monitoring', 'Executive notification']
            },
            {
                type: 'Vishing Attack',
                severity: 'high',
                category: 'Social Engineering',
                ttps: ['T1566', 'T1598'],
                playbook: ['Document call details', 'Verify no credentials shared', 'Check for unauthorized changes', 'Alert help desk', 'User awareness training']
            },
            // High - Network (5)
            {
                type: 'Lateral Movement',
                severity: 'high',
                category: 'Network',
                ttps: ['T1021', 'T1570', 'T1550'],
                playbook: ['Map affected systems', 'Review authentication logs', 'Check service accounts', 'Network segmentation review', 'Credential rotation']
            },
            {
                type: 'Network Intrusion',
                severity: 'high',
                category: 'Network',
                ttps: ['T1190', 'T1133', 'T1021'],
                playbook: ['Identify entry point', 'Review firewall logs', 'Check VPN connections', 'Assess compromised systems', 'Patch vulnerabilities']
            },
            {
                type: 'DNS Tunneling',
                severity: 'high',
                category: 'Network',
                ttps: ['T1071.004', 'T1048.003'],
                playbook: ['Block suspicious domains', 'Analyze DNS query logs', 'Identify affected hosts', 'Extract tunneled data', 'Update DNS monitoring']
            },
            {
                type: 'VPN Compromise',
                severity: 'high',
                category: 'Network',
                ttps: ['T1133', 'T1078'],
                playbook: ['Revoke VPN sessions', 'Review connection logs', 'Check for credential theft', 'Rotate VPN certificates', 'Enable additional MFA']
            },
            {
                type: 'Wireless Attack',
                severity: 'high',
                category: 'Network',
                ttps: ['T1557', 'T1040'],
                playbook: ['Identify rogue access point', 'Check for MitM indicators', 'Review wireless logs', 'Physical security sweep', 'Update wireless security']
            },
            // High - Access (4)
            {
                type: 'Privilege Escalation',
                severity: 'high',
                category: 'Access',
                ttps: ['T1068', 'T1548', 'T1134'],
                playbook: ['Review privilege changes', 'Check exploited vulnerabilities', 'Audit admin accounts', 'Patch systems', 'Reset credentials']
            },
            {
                type: 'Unauthorized Admin Access',
                severity: 'high',
                category: 'Access',
                ttps: ['T1078.002', 'T1136'],
                playbook: ['Disable compromised account', 'Review admin actions', 'Check for persistence', 'Audit group memberships', 'Reset admin passwords']
            },
            {
                type: 'Service Account Abuse',
                severity: 'high',
                category: 'Access',
                ttps: ['T1078.001', 'T1136.001'],
                playbook: ['Identify abused account', 'Review account activity', 'Check for scheduled tasks', 'Rotate service credentials', 'Implement least privilege']
            },
            {
                type: 'Cloud IAM Compromise',
                severity: 'high',
                category: 'Access',
                ttps: ['T1078.004', 'T1098'],
                playbook: ['Revoke cloud sessions', 'Review IAM changes', 'Check resource access', 'Reset API keys', 'Enable cloud audit logging']
            },
            // Medium - Execution (5)
            {
                type: 'Suspicious PowerShell',
                severity: 'medium',
                category: 'Execution',
                ttps: ['T1059.001', 'T1027'],
                playbook: ['Capture script content', 'Decode obfuscation', 'Check execution context', 'Review process tree', 'Endpoint scan']
            },
            {
                type: 'Macro Execution',
                severity: 'medium',
                category: 'Execution',
                ttps: ['T1204.002', 'T1059'],
                playbook: ['Quarantine document', 'Review macro content', 'Check for downloads', 'Scan user endpoint', 'Block at email gateway']
            },
            {
                type: 'WMI Abuse',
                severity: 'medium',
                category: 'Execution',
                ttps: ['T1047', 'T1546.003'],
                playbook: ['Review WMI subscriptions', 'Check for persistence', 'Analyze executed commands', 'Remove malicious WMI objects', 'Enable WMI logging']
            },
            {
                type: 'Scheduled Task Created',
                severity: 'medium',
                category: 'Execution',
                ttps: ['T1053.005', 'T1059'],
                playbook: ['Review task details', 'Check task creator', 'Analyze scheduled command', 'Remove if malicious', 'Monitor for recreation']
            },
            {
                type: 'LOLBin Execution',
                severity: 'medium',
                category: 'Execution',
                ttps: ['T1218', 'T1216'],
                playbook: ['Identify LOLBin used', 'Check execution context', 'Review downloaded content', 'Assess endpoint compromise', 'Block at application control']
            },
            // Medium - Discovery (3)
            {
                type: 'Internal Reconnaissance',
                severity: 'medium',
                category: 'Discovery',
                ttps: ['T1087', 'T1082', 'T1016'],
                playbook: ['Identify reconnaissance scope', 'Check source account', 'Review discovery commands', 'Assess attacker knowledge', 'Increase monitoring']
            },
            {
                type: 'Port Scanning',
                severity: 'medium',
                category: 'Discovery',
                ttps: ['T1046', 'T1135'],
                playbook: ['Identify scan source', 'Review targeted ports', 'Check for exploitation attempts', 'Block scanner IP', 'Verify scan authorization']
            },
            {
                type: 'Active Directory Enumeration',
                severity: 'medium',
                category: 'Discovery',
                ttps: ['T1087.002', 'T1069'],
                playbook: ['Review LDAP queries', 'Identify querying account', 'Check for BloodHound', 'Assess enumeration depth', 'Deploy AD honeypots']
            },
            // Medium - Persistence (4)
            {
                type: 'Web Shell Detected',
                severity: 'medium',
                category: 'Persistence',
                ttps: ['T1505.003', 'T1059'],
                playbook: ['Identify web shell location', 'Analyze shell capabilities', 'Check for data access', 'Remove and patch', 'Review web logs']
            },
            {
                type: 'Registry Persistence',
                severity: 'medium',
                category: 'Persistence',
                ttps: ['T1547.001', 'T1112'],
                playbook: ['Identify registry modifications', 'Analyze persistence payload', 'Check for execution', 'Remove registry keys', 'Scan endpoint']
            },
            {
                type: 'Bootkit/Rootkit',
                severity: 'medium',
                category: 'Persistence',
                ttps: ['T1542', 'T1014'],
                playbook: ['Boot from clean media', 'Scan boot records', 'Check for hidden processes', 'Reimage if confirmed', 'Replace hardware if needed']
            },
            {
                type: 'Backdoor Installed',
                severity: 'medium',
                category: 'Persistence',
                ttps: ['T1547', 'T1543'],
                playbook: ['Identify backdoor type', 'Analyze C2 capabilities', 'Remove persistence', 'Block C2 infrastructure', 'Full system scan']
            },
            // Low - Policy (3)
            {
                type: 'Policy Violation',
                severity: 'low',
                category: 'Compliance',
                ttps: ['T1078', 'T1052'],
                playbook: ['Document violation', 'Contact user/manager', 'Assess risk level', 'Update policy if needed', 'Training recommendation']
            },
            {
                type: 'Shadow IT Detected',
                severity: 'low',
                category: 'Compliance',
                ttps: ['T1204', 'T1567'],
                playbook: ['Identify unauthorized service', 'Assess data exposure', 'Contact service owner', 'Evaluate for approval', 'Block if necessary']
            },
            {
                type: 'Crypto Mining Detected',
                severity: 'low',
                category: 'Compliance',
                ttps: ['T1496', 'T1059'],
                playbook: ['Identify mining software', 'Check installation source', 'Remove miner', 'Block mining pools', 'User notification']
            }
        ];
        
        const analysts = ['John Smith', 'Sarah Chen', 'Mike Johnson', 'Emily Davis', 'Alex Turner', 'Jessica Martinez', 'David Kim', 'Rachel Green', 'Thomas Anderson', 'Maria Rodriguez', 'James Wilson', 'Amanda Foster', 'Robert Chang', 'Lisa Thompson', 'Kevin O\'Brien'];
        
        let incidents = [];
        let selectedIncident = null;
        let incidentIdCounter = 2024001;
        let notes = [];
        
        // Generate Incident
        function generateIncident() {
            const template = incidentTypes[Math.floor(Math.random() * incidentTypes.length)];
            const statuses = ['new', 'investigating', 'contained'];
            
            return {
                id: `INC-${incidentIdCounter++}`,
                type: template.type,
                severity: template.severity,
                category: template.category,
                status: statuses[Math.floor(Math.random() * statuses.length)],
                analyst: analysts[Math.floor(Math.random() * analysts.length)],
                created: new Date(Date.now() - Math.random() * 86400000),
                ttps: template.ttps,
                playbook: template.playbook.map((step, i) => ({
                    text: step,
                    completed: i < Math.floor(Math.random() * template.playbook.length)
                })),
                iocs: generateIOCs(),
                assets: generateAffectedAssets(),
                timeline: generateTimeline(template.ttps)
            };
        }
        
        // Generate IOCs
        function generateIOCs() {
            const iocs = [];
            const types = ['ip', 'hash', 'domain', 'file'];
            const count = Math.floor(Math.random() * 4) + 2;
            
            for (let i = 0; i < count; i++) {
                const type = types[Math.floor(Math.random() * types.length)];
                let value;
                
                switch(type) {
                    case 'ip':
                        value = `${Math.floor(Math.random() * 223) + 1}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}.${Math.floor(Math.random() * 255)}`;
                        break;
                    case 'hash':
                        value = Array(32).fill(0).map(() => '0123456789abcdef'[Math.floor(Math.random() * 16)]).join('');
                        break;
                    case 'domain':
                        const domains = ['malware-c2.evil', 'data-exfil.bad', 'phish-server.net', 'backdoor.xyz'];
                        value = domains[Math.floor(Math.random() * domains.length)];
                        break;
                    case 'file':
                        const files = ['payload.exe', 'dropper.dll', 'beacon.ps1', 'miner.js'];
                        value = files[Math.floor(Math.random() * files.length)];
                        break;
                }
                
                iocs.push({ type, value });
            }
            
            return iocs;
        }
        
        // Generate Affected Assets
        function generateAffectedAssets() {
            const assets = [];
            const names = ['WKS-001', 'SRV-DB-01', 'WKS-ADMIN', 'SRV-WEB-02', 'DC-01', 'SRV-FILE-01'];
            const types = ['Workstation', 'Server', 'Domain Controller', 'Database'];
            const count = Math.floor(Math.random() * 3) + 1;
            
            for (let i = 0; i < count; i++) {
                assets.push({
                    name: names[Math.floor(Math.random() * names.length)],
                    type: types[Math.floor(Math.random() * types.length)],
                    status: ['compromised', 'at-risk', 'clean'][Math.floor(Math.random() * 3)]
                });
            }
            
            return assets;
        }
        
        // Generate Timeline
        function generateTimeline(ttps) {
            const events = [
                { title: 'Initial Access Detected', desc: 'Suspicious login from external IP' },
                { title: 'Malware Execution', desc: 'PowerShell script executed with encoded payload' },
                { title: 'Persistence Established', desc: 'Registry modification detected for auto-start' },
                { title: 'Discovery Activity', desc: 'Network enumeration commands observed' },
                { title: 'Lateral Movement', desc: 'SMB connections to internal systems' },
                { title: 'Data Collection', desc: 'Sensitive files accessed and staged' },
                { title: 'Command & Control', desc: 'Outbound connection to suspicious domain' }
            ];
            
            const count = Math.floor(Math.random() * 4) + 3;
            const timeline = [];
            let time = Date.now() - 3600000; // Start 1 hour ago
            
            for (let i = 0; i < count; i++) {
                const event = events[i % events.length];
                timeline.push({
                    time: new Date(time),
                    title: event.title,
                    description: event.desc,
                    ttp: ttps[i % ttps.length]
                });
                time += Math.floor(Math.random() * 600000) + 300000; // 5-15 min intervals
            }
            
            return timeline;
        }
        
        // Render Incident List
        function renderIncidentList() {
            const list = document.getElementById('incident-list');
            list.innerHTML = incidents.map(inc => `
                <div class="incident-item severity-${inc.severity} ${selectedIncident?.id === inc.id ? 'selected' : ''}" 
                     onclick="selectIncident('${inc.id}')">
                    <div class="incident-id">${inc.id}</div>
                    <div class="incident-title">${inc.type}</div>
                    <div class="incident-meta">
                        <span class="incident-status status-${inc.status}">${inc.status}</span>
                        <span>${formatTime(inc.created)}</span>
                    </div>
                </div>
            `).join('');
            
            document.getElementById('queue-count').textContent = incidents.length;
        }
        
        // Select Incident
        function selectIncident(id) {
            selectedIncident = incidents.find(i => i.id === id);
            renderIncidentList();
            renderCaseDetails();
            renderTimeline();
            renderPlaybook();
        }
        
        // Render Case Details
        function renderCaseDetails() {
            if (!selectedIncident) return;
            
            document.getElementById('case-id').textContent = selectedIncident.id;
            
            document.getElementById('case-overview').innerHTML = `
                <div class="case-info-item">
                    <div class="case-info-label">Type</div>
                    <div class="case-info-value">${selectedIncident.type}</div>
                </div>
                <div class="case-info-item">
                    <div class="case-info-label">Severity</div>
                    <div class="case-info-value" style="text-transform: uppercase; color: ${
                        selectedIncident.severity === 'critical' ? '#ff4757' :
                        selectedIncident.severity === 'high' ? '#ffa502' : '#ffd43b'
                    }">${selectedIncident.severity}</div>
                </div>
                <div class="case-info-item">
                    <div class="case-info-label">Category</div>
                    <div class="case-info-value">${selectedIncident.category}</div>
                </div>
                <div class="case-info-item">
                    <div class="case-info-label">Assigned To</div>
                    <div class="case-info-value">${selectedIncident.analyst}</div>
                </div>
                <div class="case-info-item">
                    <div class="case-info-label">Created</div>
                    <div class="case-info-value">${selectedIncident.created.toLocaleString()}</div>
                </div>
                <div class="case-info-item">
                    <div class="case-info-label">Status</div>
                    <div class="case-info-value"><span class="incident-status status-${selectedIncident.status}">${selectedIncident.status}</span></div>
                </div>
            `;
            
            document.getElementById('ioc-list').innerHTML = selectedIncident.iocs.map(ioc => `
                <div class="ioc-item">
                    <span class="ioc-type ${ioc.type}">${ioc.type.toUpperCase()}</span>
                    <span>${ioc.value}</span>
                </div>
            `).join('');
            
            document.getElementById('assets-grid').innerHTML = selectedIncident.assets.map(asset => `
                <div class="asset-item">
                    <div class="asset-icon">${asset.type === 'Server' ? 'üñ•Ô∏è' : asset.type === 'Domain Controller' ? 'üè¢' : 'üíª'}</div>
                    <div class="asset-info">
                        <div class="asset-name">${asset.name}</div>
                        <div class="asset-type">${asset.type}</div>
                    </div>
                    <div class="asset-status ${asset.status}"></div>
                </div>
            `).join('');
        }
        
        // Render Timeline
        function renderTimeline() {
            if (!selectedIncident) return;
            
            const container = document.getElementById('attack-timeline');
            container.innerHTML = '<div class="timeline-line"></div>';
            
            selectedIncident.timeline.forEach(event => {
                const div = document.createElement('div');
                div.className = 'timeline-event';
                div.innerHTML = `
                    <div class="timeline-time">${event.time.toLocaleTimeString()}</div>
                    <div class="timeline-title">${event.title}</div>
                    <div class="timeline-description">${event.description}</div>
                    <div class="timeline-mitre">
                        <span class="mitre-tag">${event.ttp}</span>
                    </div>
                `;
                container.appendChild(div);
            });
        }
        
        // Render Playbook
        function renderPlaybook() {
            if (!selectedIncident) return;
            
            document.getElementById('playbook-steps').innerHTML = selectedIncident.playbook.map((step, i) => `
                <div class="playbook-step">
                    <div class="playbook-checkbox ${step.completed ? 'completed' : (i === selectedIncident.playbook.findIndex(s => !s.completed) ? 'in-progress' : '')}"></div>
                    <span class="playbook-text ${step.completed ? 'completed' : ''}">${step.text}</span>
                </div>
            `).join('');
        }
        
        // Perform Action
        function performAction(action) {
            if (!selectedIncident) {
                alert('Please select an incident first');
                return;
            }
            
            const actions = {
                contain: 'Containment procedures initiated',
                isolate: 'Host isolation request sent',
                block: 'IP/Domain block rules deployed',
                scan: 'Full endpoint scan initiated',
                escalate: 'Incident escalated to Tier 3'
            };
            
            // Add to notes
            const note = {
                analyst: 'Current User',
                time: new Date(),
                text: `ACTION: ${actions[action]}`
            };
            notes.unshift(note);
            renderNotes();
            
            // Update playbook if applicable
            const nextStep = selectedIncident.playbook.find(s => !s.completed);
            if (nextStep) {
                nextStep.completed = true;
                renderPlaybook();
            }
        }
        
        // Add Note
        function addNote() {
            const input = document.getElementById('note-input');
            if (!input.value.trim()) return;
            
            notes.unshift({
                analyst: 'Current User',
                time: new Date(),
                text: input.value
            });
            
            input.value = '';
            renderNotes();
        }
        
        // Render Notes
        function renderNotes() {
            document.getElementById('notes-list').innerHTML = notes.slice(0, 10).map(note => `
                <div class="note-item">
                    <div class="note-header">
                        <span>${note.analyst}</span>
                        <span>${formatTime(note.time)}</span>
                    </div>
                    <div class="note-text">${note.text}</div>
                </div>
            `).join('');
        }
        
        // Format Time
        function formatTime(date) {
            return date.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
        }
        
        // Update Stats
        function updateStats() {
            const stats = {
                new: incidents.filter(i => i.status === 'new').length,
                investigating: incidents.filter(i => i.status === 'investigating').length,
                contained: incidents.filter(i => i.status === 'contained').length,
                resolved: Math.floor(Math.random() * 10) + 5
            };
            
            document.getElementById('active-incidents').textContent = stats.new;
            document.getElementById('investigating').textContent = stats.investigating;
            document.getElementById('contained').textContent = stats.contained;
            document.getElementById('resolved-today').textContent = stats.resolved;
        }
        
        // Update DateTime
        function updateDateTime() {
            document.getElementById('datetime').textContent = 
                new Date().toLocaleString('en-US', {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
        }
        
        // Add new incident periodically
        function addNewIncident() {
            const incident = generateIncident();
            incidents.unshift(incident);
            
            // Keep max 15 incidents
            if (incidents.length > 15) {
                incidents.pop();
            }
            
            renderIncidentList();
            updateStats();
        }
        
        // Initialize
        function init() {
            // Generate initial incidents
            for (let i = 0; i < 8; i++) {
                incidents.push(generateIncident());
            }
            
            incidents.sort((a, b) => b.created - a.created);
            
            renderIncidentList();
            updateStats();
            updateDateTime();
            
            // Select first incident
            if (incidents.length > 0) {
                selectIncident(incidents[0].id);
            }
            
            // Add initial notes
            notes = [
                { analyst: 'Sarah Chen', time: new Date(Date.now() - 300000), text: 'Initial triage completed. Confirmed malicious activity.' },
                { analyst: 'John Smith', time: new Date(Date.now() - 600000), text: 'Reviewing EDR telemetry for affected hosts.' }
            ];
            renderNotes();
            
            // Set intervals
            setInterval(updateDateTime, 1000);
            setInterval(addNewIncident, 30000); // New incident every 30 seconds
            setInterval(updateStats, 5000);
        }
        
        // Handle enter key for notes
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('note-input').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') addNote();
            });
        });
        
        init();
    </script>
</body>
</html>
